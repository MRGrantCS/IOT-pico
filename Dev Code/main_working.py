from machine import Pin
from buzzer_music import music
from picozero import LED
from random import randint
from time import sleep
import network
import socket
import uasyncio as asyncio



onboard = machine.Pin("LED", machine.Pin.OUT)

red = LED(16)
yellow = LED(17)
green = LED(18)
white = LED(19)
blue = LED(20)

#One buzzer on pin 15
#song = '0 A#4 1 0;0 D5 1 0;0 F5 1 0;6 C5 1 0;6 E5 1 0;6 G5 1 0;12 C5 1 0;16 C5 1 0;16 E5 1 0;16 G5 1 0;22 A5 1 0;22 F5 1 0;22 D5 1 0;28 C6 0.5 0;29 A#5 0.5 0;30 A5 1 0;32 F5 1 0;32 D5 1 0;32 A#4 1 0;38 C5 1 0;38 E5 1 0;38 G5 1 0;58 C5 1 0;59 C5 1 0;60 D5 1 0;61 F5 1 0;63 F5 1 0;64 F5 1 0;64 D5 1 0;64 A#4 1 0;44 C5 1 0;70 G5 1 0;70 E5 1 0;70 C5 1 0;80 C5 1 0;80 E5 1 0;80 G5 1 0;76 C5 1 0;86 A5 1 0;86 F5 1 0;86 D5 1 0;92 C6 1 0;93 A#5 1 0;94 A5 1 0;96 A#4 1 0;96 D5 1 0;96 F5 1 0;102 G5 1 0;102 E5 1 0;102 C5 1 0;108 C5 1 0;112 C5 1 0;112 E5 1 0;114 F5 1 0;116 A4 1 0;116 D5 1 0;116 F5 1 0'
song1 = '0 A#4 1 0;0 D5 1 0;0 F5 1 0;6 C5 1 0;6 E5 1 0;6 G5 1 0;12 C5 1 0;16 C5 1 0;16 E5 1 0;16 G5 1 0;22 A5 1 0;22 F5 1 0;22 D5 1 0;28 C6 0.5 0;29 A#5 0.5 0;30 A5 1 0;32 F5 1 0;32 D5 1 0;32 A#4 1 0;38 C5 1 0;38 E5 1 0;38 G5 1 0;58 C5 1 0;59 C5 1 0;60 D5 1 0;61 F5 1 0;63 F5 1 0;64 F5 1 0;64 D5 1 0;64 A#4 1 0;44 C5 1 0;70 G5 1 0;70 E5 1 0;70 C5 1 0;80 C5 1 0;80 E5 1 0;80 G5 1 0;76 C5 1 0;86 A5 1 0;86 F5 1 0;86 D5 1 0;92 C6 1 0;93 A#5 1 0;94 A5 1 0;96 A#4 1 0;96 D5 1 0;96 F5 1 0;102 G5 1 0;102 E5 1 0;102 C5 1 0;108 C5 1 0;112 C5 1 0;112 E5 1 0;114 F5 1 0;116 A4 1 0;116 D5 1 0;116 F5 1 0'
song2 = '176 A#3 2 48;16 D#2 1 38;20 D#2 1 38;24 D#2 1 38;28 D#2 1 38;16 B2 1 38;20 B2 1 38;24 B2 1 38;28 B2 1 38;18 C3 1 38;22 C3 1 38;26 C3 1 38;30 C3 1 38;0 B5 2 34;3 C#6 2 34;6 F#5 2 34;9 G#5 2 34;0 D#2 1 38;4 D#2 1 38;8 D#2 1 38;12 D#2 1 38;0 B2 1 38;4 B2 1 38;8 B2 1 38;12 B2 1 38;2 C3 1 38;6 C3 1 38;10 C3 1 38;14 C3 1 38;48 D#2 1 38;52 D#2 1 38;56 D#2 1 38;60 D#2 1 38;48 B2 1 38;52 B2 1 38;56 B2 1 38;60 B2 1 38;50 C3 1 38;54 C3 1 38;58 C3 1 38;62 C3 1 38;32 D#2 1 38;36 D#2 1 38;40 D#2 1 38;44 D#2 1 38;32 B2 1 38;36 B2 1 38;40 B2 1 38;44 B2 1 38;34 C3 1 38;38 C3 1 38;42 C3 1 38;46 C3 1 38;12 E5 2 34;14 C#5 2 34;16 A5 2 34;19 E5 2 34;22 B5 2 34;25 E5 2 34;28 D#5 2 34;30 B4 2 34;60 D#6 4 34;60 B5 4 34;0 F#5 2 34;3 G#5 2 34;6 C#5 2 34;12 C#5 2 34;9 G#4 2 34;14 A4 2 34;16 C#5 2 34;19 B4 2 34;22 F#5 2 34;25 C#5 2 34;28 B4 2 34;30 G#4 2 34;32 B5 2 34;35 C#6 2 34;38 F#5 2 34;41 G#5 2 34;44 E5 2 34;46 C#5 2 34;48 A5 2 34;51 E5 2 34;54 B5 2 34;57 E6 2 34;32 F#5 2 34;35 G#5 2 34;38 C#5 2 34;44 C#5 2 34;41 G#4 2 34;46 A4 2 34;48 C#5 2 34;51 B4 2 34;54 F#5 2 34;57 C#6 2 34;0 G#5 2 49;3 G#5 2 49;6 F#5 2 49;9 F#5 2 49;12 E5 2 49;14 D#5 2 49;12 C#5 2 49;14 B4 2 49;0 E5 2 49;3 E5 2 49;6 D#5 2 49;9 D#5 2 49;0 C#5 2 49;3 C#5 2 49;6 B4 2 49;9 B4 2 49;32 G#5 2 49;35 G#5 2 49;38 F#5 2 49;41 F#5 2 49;44 E5 2 49;46 D#5 2 49;44 C#5 2 49;46 B4 2 49;32 E5 2 49;35 E5 2 49;38 D#5 2 49;41 D#5 2 49;32 C#5 2 49;35 C#5 2 49;38 B4 2 49;41 B4 2 49;16 E5 2 49;19 E5 2 49;22 F#5 2 49;25 F#5 2 49;28 G#5 2 49;30 F#5 2 49;30 D#5 2 49;28 E5 2 49;16 A4 2 49;19 A4 2 49;22 B4 2 49;25 B4 2 49;16 C#5 2 49;19 C#5 2 49;22 D#5 2 49;25 D#5 2 49;48 E5 2 49;51 E5 2 49;54 F#5 2 49;48 A4 2 49;51 A4 2 49;54 B4 2 49;48 C#5 2 49;51 C#5 2 49;54 D#5 2 49;60 F#4 4 49;60 F#5 4 49;57 C#6 2 49;57 G#5 2 49;57 G#4 2 49;0 G#6 2 49;3 G#6 2 49;6 F#6 2 49;9 F#6 2 49;12 E6 2 49;14 D#6 2 49;12 C#6 2 49;14 B5 2 49;0 E6 2 49;3 E6 2 49;6 D#6 2 49;9 D#6 2 49;0 C#6 2 49;3 C#6 2 49;6 B5 2 49;9 B5 2 49;32 G#6 2 49;35 G#6 2 49;38 F#6 2 49;41 F#6 2 49;44 E6 2 49;46 D#6 2 49;44 C#6 2 49;46 B5 2 49;32 E6 2 49;35 E6 2 49;38 D#6 2 49;41 D#6 2 49;32 C#6 2 49;35 C#6 2 49;38 B5 2 49;41 B5 2 49;16 E6 2 49;19 E6 2 49;22 F#6 2 49;25 F#6 2 49;28 G#6 2 49;30 F#6 2 49;30 D#6 2 49;28 E6 2 49;16 A5 2 49;19 A5 2 49;22 B5 2 49;25 B5 2 49;16 C#6 2 49;19 C#6 2 49;22 D#6 2 49;25 D#6 2 49;48 E6 2 49;51 E6 2 49;54 F#6 2 49;48 A5 2 49;51 A5 2 49;54 B5 2 49;48 C#6 2 49;51 C#6 2 49;54 D#6 2 49;60 F#5 4 49;60 F#6 4 49;57 C#7 2 49;57 G#6 2 49;57 G#5 2 49;0 G#4 2 49;3 G#4 2 49;6 F#4 2 49;9 F#4 2 49;12 E4 2 49;14 D#4 2 49;12 C#4 2 49;14 B3 2 49;0 E4 2 49;3 E4 2 49;6 D#4 2 49;9 D#4 2 49;0 C#4 2 49;3 C#4 2 49;6 B3 2 49;9 B3 2 49;32 G#4 2 49;35 G#4 2 49;38 F#4 2 49;41 F#4 2 49;44 E4 2 49;46 D#4 2 49;44 C#4 2 49;46 B3 2 49;32 E4 2 49;35 E4 2 49;38 D#4 2 49;41 D#4 2 49;32 C#4 2 49;35 C#4 2 49;38 B3 2 49;41 B3 2 49;16 E4 2 49;19 E4 2 49;22 F#4 2 49;25 F#4 2 49;28 G#4 2 49;30 F#4 2 49;30 D#4 2 49;28 E4 2 49;16 A3 2 49;19 A3 2 49;22 B3 2 49;25 B3 2 49;16 C#4 2 49;19 C#4 2 49;22 D#4 2 49;25 D#4 2 49;48 E4 2 49;51 E4 2 49;54 F#4 2 49;48 A3 2 49;51 A3 2 49;54 B3 2 49;48 C#4 2 49;51 C#4 2 49;54 D#4 2 49;60 F#3 4 49;60 F#4 4 49;57 C#5 2 49;57 G#4 2 49;57 G#3 2 49;0 B6 2 38;3 C#7 2 38;6 F#6 2 38;9 G#6 2 38;12 E6 2 38;14 C#6 2 38;16 A6 2 38;19 E6 2 38;22 B6 2 38;25 E6 2 38;28 D#6 2 38;30 B5 2 38;32 B6 2 38;35 C#7 2 38;38 F#6 2 38;41 G#6 2 38;44 E6 2 38;46 C#6 2 38;48 A6 2 38;51 E6 2 38;54 B6 2 38;57 E7 2 38;60 D#7 4 38;0 C#4 2 48;3 C#4 2 48;6 C#4 2 48;9 C#4 2 48;12 C#4 2 48;14 B3 2 48;16 C#4 2 48;19 C#4 2 48;22 C#4 2 48;25 C#4 2 48;28 C#4 2 48;30 B3 2 48;32 C#4 2 48;35 C#4 2 48;38 C#4 2 48;41 C#4 2 48;44 C#4 2 48;46 B3 2 48;48 A3 2 48;51 A3 2 48;54 B3 2 48;57 B3 2 48;60 B3 2 48;62 C4 2 48;0 C#3 2 17;3 C#3 2 17;6 C#3 2 17;9 C#3 2 17;12 C#3 2 17;14 B2 2 17;16 C#3 2 17;19 C#3 2 17;22 C#3 2 17;25 C#3 2 17;28 C#3 2 17;30 B2 2 17;32 C#3 2 17;35 C#3 2 17;38 C#3 2 17;41 C#3 2 17;44 C#3 2 17;46 B2 2 17;48 A2 2 17;51 A2 2 17;54 B2 2 17;57 B2 2 17;60 B2 2 17;62 C3 2 17;80 D#2 1 38;84 D#2 1 38;88 D#2 1 38;92 D#2 1 38;80 B2 1 38;84 B2 1 38;88 B2 1 38;92 B2 1 38;82 C3 1 38;86 C3 1 38;90 C3 1 38;94 C3 1 38;64 B5 2 34;67 C#6 2 34;70 F#5 2 34;73 G#5 2 34;64 D#2 1 38;68 D#2 1 38;72 D#2 1 38;76 D#2 1 38;64 B2 1 38;68 B2 1 38;72 B2 1 38;76 B2 1 38;66 C3 1 38;70 C3 1 38;74 C3 1 38;78 C3 1 38;112 D#2 1 38;116 D#2 1 38;120 D#2 1 38;124 D#2 1 38;112 B2 1 38;116 B2 1 38;120 B2 1 38;124 B2 1 38;114 C3 1 38;118 C3 1 38;122 C3 1 38;126 C3 1 38;96 D#2 1 38;100 D#2 1 38;104 D#2 1 38;108 D#2 1 38;96 B2 1 38;100 B2 1 38;104 B2 1 38;108 B2 1 38;98 C3 1 38;102 C3 1 38;106 C3 1 38;110 C3 1 38;76 E5 2 34;78 C#5 2 34;80 A5 2 34;83 E5 2 34;86 B5 2 34;89 E5 2 34;92 D#5 2 34;94 B4 2 34;124 D#6 4 34;124 B5 4 34;64 F#5 2 34;67 G#5 2 34;70 C#5 2 34;76 C#5 2 34;73 G#4 2 34;78 A4 2 34;80 C#5 2 34;83 B4 2 34;86 F#5 2 34;89 C#5 2 34;92 B4 2 34;94 G#4 2 34;96 B5 2 34;99 C#6 2 34;102 F#5 2 34;105 G#5 2 34;108 E5 2 34;110 C#5 2 34;112 A5 2 34;115 E5 2 34;118 B5 2 34;121 E6 2 34;96 F#5 2 34;99 G#5 2 34;102 C#5 2 34;108 C#5 2 34;105 G#4 2 34;110 A4 2 34;112 C#5 2 34;115 B4 2 34;118 F#5 2 34;121 C#6 2 34;64 G#5 2 49;67 G#5 2 49;70 F#5 2 49;73 F#5 2 49;76 E5 2 49;78 D#5 2 49;76 C#5 2 49;78 B4 2 49;64 E5 2 49;67 E5 2 49;70 D#5 2 49;73 D#5 2 49;64 C#5 2 49;67 C#5 2 49;70 B4 2 49;73 B4 2 49;96 G#5 2 49;99 G#5 2 49;102 F#5 2 49;105 F#5 2 49;108 E5 2 49;110 D#5 2 49;108 C#5 2 49;110 B4 2 49;96 E5 2 49;99 E5 2 49;102 D#5 2 49;105 D#5 2 49;96 C#5 2 49;99 C#5 2 49;102 B4 2 49;105 B4 2 49;80 E5 2 49;83 E5 2 49;86 F#5 2 49;89 F#5 2 49;92 G#5 2 49;94 F#5 2 49;94 D#5 2 49;92 E5 2 49;80 A4 2 49;83 A4 2 49;86 B4 2 49;89 B4 2 49;80 C#5 2 49;83 C#5 2 49;86 D#5 2 49;89 D#5 2 49;112 E5 2 49;115 E5 2 49;118 F#5 2 49;112 A4 2 49;115 A4 2 49;118 B4 2 49;112 C#5 2 49;115 C#5 2 49;118 D#5 2 49;124 F#4 4 49;124 F#5 4 49;121 C#6 2 49;121 G#5 2 49;121 G#4 2 49;64 G#6 2 49;67 G#6 2 49;70 F#6 2 49;73 F#6 2 49;76 E6 2 49;78 D#6 2 49;76 C#6 2 49;78 B5 2 49;64 E6 2 49;67 E6 2 49;70 D#6 2 49;73 D#6 2 49;64 C#6 2 49;67 C#6 2 49;70 B5 2 49;73 B5 2 49;96 G#6 2 49;99 G#6 2 49;102 F#6 2 49;105 F#6 2 49;108 E6 2 49;110 D#6 2 49;108 C#6 2 49;110 B5 2 49;96 E6 2 49;99 E6 2 49;102 D#6 2 49;105 D#6 2 49;96 C#6 2 49;99 C#6 2 49;102 B5 2 49;105 B5 2 49;80 E6 2 49;83 E6 2 49;86 F#6 2 49;89 F#6 2 49;92 G#6 2 49;94 F#6 2 49;94 D#6 2 49;92 E6 2 49;80 A5 2 49;83 A5 2 49;86 B5 2 49;89 B5 2 49;80 C#6 2 49;83 C#6 2 49;86 D#6 2 49;89 D#6 2 49;112 E6 2 49;115 E6 2 49;118 F#6 2 49;112 A5 2 49;115 A5 2 49;118 B5 2 49;112 C#6 2 49;115 C#6 2 49;118 D#6 2 49;124 F#5 4 49;124 F#6 4 49;121 C#7 2 49;121 G#6 2 49;121 G#5 2 49;64 G#4 2 49;67 G#4 2 49;70 F#4 2 49;73 F#4 2 49;76 E4 2 49;78 D#4 2 49;76 C#4 2 49;78 B3 2 49;64 E4 2 49;67 E4 2 49;70 D#4 2 49;73 D#4 2 49;64 C#4 2 49;67 C#4 2 49;70 B3 2 49;73 B3 2 49;96 G#4 2 49;99 G#4 2 49;102 F#4 2 49;105 F#4 2 49;108 E4 2 49;110 D#4 2 49;108 C#4 2 49;110 B3 2 49;96 E4 2 49;99 E4 2 49;102 D#4 2 49;105 D#4 2 49;96 C#4 2 49;99 C#4 2 49;102 B3 2 49;105 B3 2 49;80 E4 2 49;83 E4 2 49;86 F#4 2 49;89 F#4 2 49;92 G#4 2 49;94 F#4 2 49;94 D#4 2 49;92 E4 2 49;80 A3 2 49;83 A3 2 49;86 B3 2 49;89 B3 2 49;80 C#4 2 49;83 C#4 2 49;86 D#4 2 49;89 D#4 2 49;112 E4 2 49;115 E4 2 49;118 F#4 2 49;112 A3 2 49;115 A3 2 49;118 B3 2 49;112 C#4 2 49;115 C#4 2 49;118 D#4 2 49;124 F#3 4 49;124 F#4 4 49;121 C#5 2 49;121 G#4 2 49;121 G#3 2 49;64 B6 2 38;67 C#7 2 38;70 F#6 2 38;73 G#6 2 38;76 E6 2 38;78 C#6 2 38;80 A6 2 38;83 E6 2 38;86 B6 2 38;89 E6 2 38;92 D#6 2 38;94 B5 2 38;96 B6 2 38;99 C#7 2 38;102 F#6 2 38;105 G#6 2 38;108 E6 2 38;110 C#6 2 38;112 A6 2 38;115 E6 2 38;118 B6 2 38;121 E7 2 38;124 D#7 4 38;64 C#4 2 48;67 C#4 2 48;70 C#4 2 48;73 C#4 2 48;76 C#4 2 48;78 B3 2 48;80 C#4 2 48;83 C#4 2 48;86 C#4 2 48;89 C#4 2 48;92 C#4 2 48;94 B3 2 48;96 C#4 2 48;99 C#4 2 48;102 C#4 2 48;105 C#4 2 48;108 C#4 2 48;110 B3 2 48;112 A3 2 48;115 A3 2 48;118 B3 2 48;121 B3 2 48;124 B3 2 48;126 C4 2 48;64 C#3 2 17;67 C#3 2 17;70 C#3 2 17;73 C#3 2 17;76 C#3 2 17;78 B2 2 17;80 C#3 2 17;83 C#3 2 17;86 C#3 2 17;89 C#3 2 17;92 C#3 2 17;94 B2 2 17;96 C#3 2 17;99 C#3 2 17;102 C#3 2 17;105 C#3 2 17;108 C#3 2 17;110 B2 2 17;112 A2 2 17;115 A2 2 17;118 B2 2 17;121 B2 2 17;124 B2 2 17;126 C3 2 17;144 D#2 1 38;148 D#2 1 38;152 D#2 1 38;156 D#2 1 38;144 B2 1 38;148 B2 1 38;152 B2 1 38;156 B2 1 38;146 C3 1 38;150 C3 1 38;154 C3 1 38;158 C3 1 38;128 C6 2 34;131 D6 2 34;134 G5 2 34;137 A5 2 34;128 D#2 1 38;132 D#2 1 38;136 D#2 1 38;140 D#2 1 38;128 B2 1 38;132 B2 1 38;136 B2 1 38;140 B2 1 38;130 C3 1 38;134 C3 1 38;138 C3 1 38;142 C3 1 38;176 D#2 1 38;180 D#2 1 38;184 D#2 1 38;188 D#2 1 38;176 B2 1 38;180 B2 1 38;184 B2 1 38;188 B2 1 38;178 C3 1 38;182 C3 1 38;186 C3 1 38;190 C3 1 38;160 D#2 1 38;164 D#2 1 38;168 D#2 1 38;172 D#2 1 38;160 B2 1 38;164 B2 1 38;168 B2 1 38;172 B2 1 38;162 C3 1 38;166 C3 1 38;170 C3 1 38;174 C3 1 38;140 F5 2 34;142 D5 2 34;144 A#5 2 34;147 F5 2 34;150 C6 2 34;153 F5 2 34;156 E5 2 34;158 C5 2 34;188 E6 4 34;188 C6 4 34;128 G5 2 34;131 A5 2 34;134 D5 2 34;140 D5 2 34;137 A4 2 34;142 A#4 2 34;144 D5 2 34;147 C5 2 34;150 G5 2 34;153 D5 2 34;156 C5 2 34;158 A4 2 34;160 C6 2 34;163 D6 2 34;166 G5 2 34;169 A5 2 34;172 F5 2 34;174 D5 2 34;176 A#5 2 34;179 F5 2 34;182 C6 2 34;185 F6 2 34;160 G5 2 34;163 A5 2 34;166 D5 2 34;172 D5 2 34;169 A4 2 34;174 A#4 2 34;176 D5 2 34;179 C5 2 34;182 G5 2 34;185 D6 2 34;128 A5 2 49;131 A5 2 49;134 G5 2 49;137 G5 2 49;140 F5 2 49;142 E5 2 49;140 D5 2 49;142 C5 2 49;128 F5 2 49;131 F5 2 49;134 E5 2 49;137 E5 2 49;128 D5 2 49;131 D5 2 49;134 C5 2 49;137 C5 2 49;160 A5 2 49;163 A5 2 49;166 G5 2 49;169 G5 2 49;172 F5 2 49;174 E5 2 49;172 D5 2 49;174 C5 2 49;160 F5 2 49;163 F5 2 49;166 E5 2 49;169 E5 2 49;160 D5 2 49;163 D5 2 49;166 C5 2 49;169 C5 2 49;144 F5 2 49;147 F5 2 49;150 G5 2 49;153 G5 2 49;156 A5 2 49;158 G5 2 49;158 E5 2 49;156 F5 2 49;144 A#4 2 49;147 A#4 2 49;150 C5 2 49;153 C5 2 49;144 D5 2 49;147 D5 2 49;150 E5 2 49;153 E5 2 49;176 F5 2 49;179 F5 2 49;182 G5 2 49;176 A#4 2 49;179 A#4 2 49;182 C5 2 49;176 D5 2 49;179 D5 2 49;182 E5 2 49;188 G4 4 49;188 G5 4 49;185 D6 2 49;185 A5 2 49;185 A4 2 49;128 A6 2 49;131 A6 2 49;134 G6 2 49;137 G6 2 49;140 F6 2 49;142 E6 2 49;140 D6 2 49;142 C6 2 49;128 F6 2 49;131 F6 2 49;134 E6 2 49;137 E6 2 49;128 D6 2 49;131 D6 2 49;134 C6 2 49;137 C6 2 49;160 A6 2 49;163 A6 2 49;166 G6 2 49;169 G6 2 49;172 F6 2 49;174 E6 2 49;172 D6 2 49;174 C6 2 49;160 F6 2 49;163 F6 2 49;166 E6 2 49;169 E6 2 49;160 D6 2 49;163 D6 2 49;166 C6 2 49;169 C6 2 49;144 F6 2 49;147 F6 2 49;150 G6 2 49;153 G6 2 49;156 A6 2 49;158 G6 2 49;158 E6 2 49;156 F6 2 49;144 A#5 2 49;147 A#5 2 49;150 C6 2 49;153 C6 2 49;144 D6 2 49;147 D6 2 49;150 E6 2 49;153 E6 2 49;176 F6 2 49;179 F6 2 49;182 G6 2 49;176 A#5 2 49;179 A#5 2 49;182 C6 2 49;176 D6 2 49;179 D6 2 49;182 E6 2 49;188 G5 4 49;188 G6 4 49;185 D7 2 49;185 A6 2 49;185 A5 2 49;128 A4 2 49;131 A4 2 49;134 G4 2 49;137 G4 2 49;140 F4 2 49;142 E4 2 49;140 D4 2 49;142 C4 2 49;128 F4 2 49;131 F4 2 49;134 E4 2 49;137 E4 2 49;128 D4 2 49;131 D4 2 49;134 C4 2 49;137 C4 2 49;160 A4 2 49;163 A4 2 49;166 G4 2 49;169 G4 2 49;172 F4 2 49;174 E4 2 49;172 D4 2 49;174 C4 2 49;160 F4 2 49;163 F4 2 49;166 E4 2 49;169 E4 2 49;160 D4 2 49;163 D4 2 49;166 C4 2 49;169 C4 2 49;144 F4 2 49;147 F4 2 49;150 G4 2 49;153 G4 2 49;156 A4 2 49;158 G4 2 49;158 E4 2 49;156 F4 2 49;144 A#3 2 49;147 A#3 2 49;150 C4 2 49;153 C4 2 49;144 D4 2 49;147 D4 2 49;150 E4 2 49;153 E4 2 49;176 F4 2 49;179 F4 2 49;182 G4 2 49;176 A#3 2 49;179 A#3 2 49;182 C4 2 49;176 D4 2 49;179 D4 2 49;182 E4 2 49;188 G3 4 49;188 G4 4 49;185 D5 2 49;185 A4 2 49;185 A3 2 49;128 C7 2 38;131 D7 2 38;134 G6 2 38;137 A6 2 38;140 F6 2 38;142 D6 2 38;144 A#6 2 38;147 F6 2 38;150 C7 2 38;153 F6 2 38;156 E6 2 38;158 C6 2 38;160 C7 2 38;163 D7 2 38;166 G6 2 38;169 A6 2 38;172 F6 2 38;174 D6 2 38;176 A#6 2 38;179 F6 2 38;182 C7 2 38;185 F7 2 38;188 E7 4 38;128 D4 2 48;131 D4 2 48;134 D4 2 48;137 D4 2 48;140 D4 2 48;142 C4 2 48;144 D4 2 48;147 D4 2 48;150 D4 2 48;153 D4 2 48;156 D4 2 48;158 C4 2 48;160 D4 2 48;163 D4 2 48;166 D4 2 48;169 D4 2 48;172 D4 2 48;174 C4 2 48;179 A#3 2 48;182 C4 2 48;185 C4 2 48;188 C4 2 48;190 C#4 2 48;128 D3 2 17;131 D3 2 17;134 D3 2 17;137 D3 2 17;140 D3 2 17;142 C3 2 17;144 D3 2 17;147 D3 2 17;150 D3 2 17;153 D3 2 17;156 D3 2 17;158 C3 2 17;160 D3 2 17;163 D3 2 17;166 D3 2 17;169 D3 2 17;172 D3 2 17;174 C3 2 17;176 A#2 2 17;179 A#2 2 17;182 C3 2 17;185 C3 2 17;188 C3 2 17;190 C#3 2 17;208 D#2 1 38;212 D#2 1 38;216 D#2 1 38;220 D#2 1 38;208 B2 1 38;212 B2 1 38;216 B2 1 38;220 B2 1 38;210 C3 1 38;214 C3 1 38;218 C3 1 38;222 C3 1 38;192 C6 2 34;195 D6 2 34;198 G5 2 34;201 A5 2 34;192 D#2 1 38;196 D#2 1 38;200 D#2 1 38;204 D#2 1 38;192 B2 1 38;196 B2 1 38;200 B2 1 38;204 B2 1 38;194 C3 1 38;198 C3 1 38;202 C3 1 38;206 C3 1 38;240 D#2 1 38;244 D#2 1 38;248 D#2 1 38;252 D#2 1 38;240 B2 1 38;244 B2 1 38;248 B2 1 38;252 B2 1 38;242 C3 1 38;246 C3 1 38;250 C3 1 38;254 C3 1 38;224 D#2 1 38;228 D#2 1 38;232 D#2 1 38;236 D#2 1 38;224 B2 1 38;228 B2 1 38;232 B2 1 38;236 B2 1 38;226 C3 1 38;230 C3 1 38;234 C3 1 38;238 C3 1 38;204 F5 2 34;206 D5 2 34;208 A#5 2 34;211 F5 2 34;214 C6 2 34;217 F5 2 34;220 E5 2 34;222 C5 2 34;252 E6 4 34;252 C6 4 34;192 G5 2 34;195 A5 2 34;198 D5 2 34;204 D5 2 34;201 A4 2 34;206 A#4 2 34;208 D5 2 34;211 C5 2 34;214 G5 2 34;217 D5 2 34;220 C5 2 34;222 A4 2 34;224 C6 2 34;227 D6 2 34;230 G5 2 34;233 A5 2 34;236 F5 2 34;238 D5 2 34;240 A#5 2 34;243 F5 2 34;246 C6 2 34;249 F6 2 34;224 G5 2 34;227 A5 2 34;230 D5 2 34;236 D5 2 34;233 A4 2 34;238 A#4 2 34;240 D5 2 34;243 C5 2 34;246 G5 2 34;249 D6 2 34;192 A5 2 49;195 A5 2 49;198 G5 2 49;201 G5 2 49;204 F5 2 49;206 E5 2 49;204 D5 2 49;206 C5 2 49;192 F5 2 49;195 F5 2 49;198 E5 2 49;201 E5 2 49;192 D5 2 49;195 D5 2 49;198 C5 2 49;201 C5 2 49;224 A5 2 49;227 A5 2 49;230 G5 2 49;233 G5 2 49;236 F5 2 49;238 E5 2 49;236 D5 2 49;238 C5 2 49;224 F5 2 49;227 F5 2 49;230 E5 2 49;233 E5 2 49;224 D5 2 49;227 D5 2 49;230 C5 2 49;233 C5 2 49;208 F5 2 49;211 F5 2 49;214 G5 2 49;217 G5 2 49;220 A5 2 49;222 G5 2 49;222 E5 2 49;220 F5 2 49;208 A#4 2 49;211 A#4 2 49;214 C5 2 49;217 C5 2 49;208 D5 2 49;211 D5 2 49;214 E5 2 49;217 E5 2 49;240 F5 2 49;243 F5 2 49;246 G5 2 49;240 A#4 2 49;243 A#4 2 49;246 C5 2 49;240 D5 2 49;243 D5 2 49;246 E5 2 49;252 G4 4 49;252 G5 4 49;249 D6 2 49;249 A5 2 49;249 A4 2 49;192 A6 2 49;195 A6 2 49;198 G6 2 49;201 G6 2 49;204 F6 2 49;206 E6 2 49;204 D6 2 49;206 C6 2 49;192 F6 2 49;195 F6 2 49;198 E6 2 49;201 E6 2 49;192 D6 2 49;195 D6 2 49;198 C6 2 49;201 C6 2 49;224 A6 2 49;227 A6 2 49;230 G6 2 49;233 G6 2 49;236 F6 2 49;238 E6 2 49;236 D6 2 49;238 C6 2 49;224 F6 2 49;227 F6 2 49;230 E6 2 49;233 E6 2 49;224 D6 2 49;227 D6 2 49;230 C6 2 49;233 C6 2 49;208 F6 2 49;211 F6 2 49;214 G6 2 49;217 G6 2 49;220 A6 2 49;222 G6 2 49;222 E6 2 49;220 F6 2 49;208 A#5 2 49;211 A#5 2 49;214 C6 2 49;217 C6 2 49;208 D6 2 49;211 D6 2 49;214 E6 2 49;217 E6 2 49;240 F6 2 49;243 F6 2 49;246 G6 2 49;240 A#5 2 49;243 A#5 2 49;246 C6 2 49;240 D6 2 49;243 D6 2 49;246 E6 2 49;252 G5 4 49;252 G6 4 49;249 D7 2 49;249 A6 2 49;249 A5 2 49;192 A4 2 49;195 A4 2 49;198 G4 2 49;201 G4 2 49;204 F4 2 49;206 E4 2 49;204 D4 2 49;206 C4 2 49;192 F4 2 49;195 F4 2 49;198 E4 2 49;201 E4 2 49;192 D4 2 49;195 D4 2 49;198 C4 2 49;201 C4 2 49;224 A4 2 49;227 A4 2 49;230 G4 2 49;233 G4 2 49;236 F4 2 49;238 E4 2 49;236 D4 2 49;238 C4 2 49;224 F4 2 49;227 F4 2 49;230 E4 2 49;233 E4 2 49;224 D4 2 49;227 D4 2 49;230 C4 2 49;233 C4 2 49;208 F4 2 49;211 F4 2 49;214 G4 2 49;217 G4 2 49;220 A4 2 49;222 G4 2 49;222 E4 2 49;220 F4 2 49;208 A#3 2 49;211 A#3 2 49;214 C4 2 49;217 C4 2 49;208 D4 2 49;211 D4 2 49;214 E4 2 49;217 E4 2 49;240 F4 2 49;243 F4 2 49;246 G4 2 49;240 A#3 2 49;243 A#3 2 49;246 C4 2 49;240 D4 2 49;243 D4 2 49;246 E4 2 49;252 G3 4 49;252 G4 4 49;249 D5 2 49;249 A4 2 49;249 A3 2 49;192 C7 2 38;195 D7 2 38;198 G6 2 38;201 A6 2 38;204 F6 2 38;206 D6 2 38;208 A#6 2 38;211 F6 2 38;214 C7 2 38;217 F6 2 38;220 E6 2 38;222 C6 2 38;224 C7 2 38;227 D7 2 38;230 G6 2 38;233 A6 2 38;236 F6 2 38;238 D6 2 38;240 A#6 2 38;243 F6 2 38;246 C7 2 38;249 F7 2 38;252 E7 4 38;192 D4 2 48;195 D4 2 48;198 D4 2 48;201 D4 2 48;204 D4 2 48;206 C4 2 48;208 D4 2 48;211 D4 2 48;214 D4 2 48;217 D4 2 48;220 D4 2 48;222 C4 2 48;224 D4 2 48;227 D4 2 48;230 D4 2 48;233 D4 2 48;236 D4 2 48;238 C4 2 48;240 A#3 2 48;243 A#3 2 48;246 C4 2 48;249 C4 2 48;252 C4 2 48;254 C#4 2 48;192 D3 2 17;195 D3 2 17;198 D3 2 17;201 D3 2 17;204 D3 2 17;206 C3 2 17;208 D3 2 17;211 D3 2 17;214 D3 2 17;217 D3 2 17;220 D3 2 17;222 C3 2 17;224 D3 2 17;227 D3 2 17;230 D3 2 17;233 D3 2 17;236 D3 2 17;238 C3 2 17;240 A#2 2 17;243 A#2 2 17;246 C3 2 17;249 C3 2 17;252 C3 2 17;254 C#3 2 17'
song3 = '0 G5 9 33;0 C6 9 33;4 D5 1 33;8 C5 1 33;12 C6 9 33;12 G5 9 33;16 D5 1 33;20 C5 1 33;24 A5 1 33;28 C6 9 33;28 G5 9 33;32 D5 1 33;36 C5 1 33;40 C6 9 33;40 G5 9 33;44 D5 1 33;48 C5 1 33;56 C6 9 33;56 G5 9 33;60 D5 1 33;64 C5 1 33;68 C6 9 33;68 G5 9 33;72 D5 1 33;76 C5 1 33;80 A5 1 33;84 C6 9 33;84 G5 9 33;88 D5 1 33;92 C5 1 33;96 C6 9 33;96 G5 9 33;100 D5 1 33;104 C5 1 33;112 C6 4 33;112 G5 4 33;112 C5 1 33;112 C4 8 7;116 B5 4 33;116 D5 1 33;120 C5 1 33;120 G5 3 33;124 C6 4 33;124 G5 3 33;124 C5 1 33;124 C4 8 7;128 B5 4 33;128 D5 1 33;128 G5 4 33;132 C5 4 33;132 E5 4 33;136 A5 4 33;140 C6 4 33;140 G5 4 33;140 C5 1 33;140 C4 8 7;144 D5 1 33;144 B5 4 33;148 C5 1 33;148 G5 3 33;152 C6 4 33;152 G5 4 33;152 C5 1 33;152 C4 8 7;156 D5 4 33;156 B5 8 33;160 C5 6 33;168 C6 4 33;168 G5 3 33;168 C5 1 33;168 E5 1 33;168 C4 8 7;172 B5 4 33;172 G5 3 33;172 D5 4 33;176 C5 3 33;176 G5 3 33;180 C6 4 33;180 G5 3 33;180 E5 1 33;180 C5 1 33;180 C4 8 7;184 B5 4 33;184 G5 3 33;184 D5 4 33;188 C5 3 33;188 E5 3 33;192 A5 4 33;192 D6 4 33;196 C4 8 7;196 C5 7 33;196 G5 4 33;196 E6 4 33;200 D5 4 33;200 G6 4 33;204 C6 4 33;204 C5 3 33;208 E6 4 33;208 G5 4 33;212 G6 4 33;212 D5 4 33;216 C6 4 33;216 C5 4 33;208 C5 7 33;208 C4 7 7;224 A3 8 7;224 E5 4 33;224 B5 4 33;228 D5 4 33;228 A5 4 33;232 E5 3 33;232 A4 4 33;236 B5 4 33;236 E5 4 33;236 A3 8 7;240 D5 4 33;240 A5 4 33;244 G#5 4 33;244 A4 4 33;248 F#4 4 33;252 B5 4 33;252 E5 4 33;252 A3 8 7;256 A5 4 33;256 D5 4 33;260 E5 4 33;260 A4 4 33;264 A3 15 7;264 D5 4 33;268 C#5 4 33;272 A4 4 33;280 A3 8 7;280 E5 4 33;280 B5 4 33;284 D5 4 33;284 A5 4 33;292 B5 4 33;292 E5 4 33;292 A3 8 7;296 D5 4 33;296 A5 4 33;300 G#5 4 33;300 A4 4 33;288 A4 4 33;288 E5 3 33;288 C#6 4 33;300 E6 4 33;304 F#4 4 33;308 E6 3 33;308 C#6 4 33;308 G#6 4 33;308 A3 8 7;320 A3 8 7;320 C#6 4 33;320 E6 3 33;320 G#6 4 33;312 E6 3 33;312 A6 4 33;312 D5 4 33;316 A4 4 33;316 A5 4 33;316 E6 3 33;324 E6 3 33;324 A6 4 33;324 D5 4 33;328 A5 4 33;328 A4 4 33;120 G3 4 7;148 G3 4 7;176 G3 4 7;204 G3 4 7;132 G3 4 7;232 E3 4 7;260 E3 4 7;288 E3 4 7;316 E3 4 7'

mySong = music(song1, pins=[Pin(15)])
display = False
buzz = False

html = f"""<!DOCTYPE html>
            <html>
            <form action="./light_display_on">
            <input type="submit" value="Light Display On" />
            </form>
            <br/>
            <form action="./light_display_off">
            <input type="submit" value="Light Display Off" />
            </form>
            <br/>
            <br/>
            <form action="./song1">
            <input type="submit" value="Set Song 1" />
            </form>
            <br/>
            <form action="./song2">
            <input type="submit" value="Set Song 2" />
            </form>
            <br/>
            <form action="./song3">
            <input type="submit" value="Set Song 3" />
            </form>
            <br/>            
            <form action="./music_on">
            <input type="submit" value="Music On" />
            </form>
            <br/>
            <form action="./music_off">
            <input type="submit" value="Music Off" />
            </form>
            </body>
            </html>
"""

wlan = network.WLAN(network.AP_IF)

def get_display():
    return display

def get_buzz():
    return buzz

async def light_display():
    display = get_display()
    while display == True:
        
        number = randint(1,5)
        if number == 1:
            red.toggle()
        if number == 2:
            yellow.toggle()
        if number == 3:
            green.toggle()
        if number == 4:
            white.toggle()
        if number == 5:
            blue.toggle()
        display = get_display()
        await asyncio.sleep(0.2)
    else:
        red.off()
        yellow.off()
        green.off()
        white.off()
        blue.off()
        return

    
def traffic_lights():
    red.on()
    sleep(2)
    red.off()

    yellow.on()
    sleep(2)
    yellow.off()

    green.on()
    sleep(2)
    green.off()

async def play_music():
    buzz = get_buzz()
    mySong.restart()
    while buzz == True:
        mySong.tick()
        buzz = get_buzz()
        await asyncio.sleep(0.04)
    else:
        mySong.restart()

def ap_mode(ssid, password):
    """
        Description: This is a function to activate AP mode

        Parameters:

        ssid[str]: The name of your internet connection
        password[str]: Password for your internet connection

        Returns: Nada
    """
    print("in AP mode")
    # Just making our access point 
    ap = network.WLAN(network.AP_IF)
    ap.config(essid=ssid, password=password)
    ap.active(True)

    while ap.active() == False:
        pass
    print('AP Mode Is Active, You can Now Connect')
    print('IP Address To Connect to:: ' + ap.ifconfig()[0])
    """
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)   #creating socket object
    s.bind(('', 80))
    s.listen(5)
    """
    return ap.ifconfig()[0]

async def serve_client(reader, writer):
    global display
    global buzz
    global mySong
    
    
    print("Client connected")
    request_line = await reader.readline()
    print("Request:", request_line)
    # We are not interested in HTTP request headers, skip them
    while await reader.readline() != b"\r\n":
        pass
    
    str_request = str(request_line)
    print('Content = %s' % str_request)
    try:
        str_request = str_request.split()[1]
    except IndexError:
        pass
    if str_request == '/music_on?':
        buzz = True
        asyncio.create_task(play_music())
    elif str_request == '/music_off?':
        buzz = False
        
    elif str_request =='/song1?':
        mySong = music(song1, pins=[Pin(15)])
    elif str_request =='/song2?':
        mySong = music(song2, pins=[Pin(15)])
    elif str_request =='/song3?':
        mySong = music(song3, pins=[Pin(15)])
    
    elif str_request =='/light_display_on?':
        display = True
        asyncio.create_task(light_display())
    elif str_request =='/light_display_off?':
        display = False        
    else:
        pass
  
    response = html
    writer.write('HTTP/1.0 200 OK\r\nContent-type: text/html\r\n\r\n')
    writer.write(response)

    await writer.drain()
    await writer.wait_closed()
    print("Client disconnected")


async def main():
    print('Setting up AP mode...')
    
    ip = ap_mode('pi-pico','password')

    print('Setting up webserver...')
    asyncio.create_task(asyncio.start_server(serve_client, "0.0.0.0", 80))

    
    while True:
        onboard.on()
        print("heartbeat")
        print(display)
        await asyncio.sleep(0.25)
        onboard.off()
        await asyncio.sleep(5)
        
try:
    asyncio.run(main())
finally:
    asyncio.new_event_loop()

